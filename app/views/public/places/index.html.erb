<class="container-fluid mt-4">
  <h1 class="mb-4">施設・公園一覧</h1>
<!--検索-->
  <div class="mb-3">
    <input type="text" id="keyword-search" class="form-control" placeholder="キーワードで検索（例: 渋谷 授乳室）">
    <button class="btn btn-outline-primary" id="search-btn">検索</button>
  </div>

  <div class="mb-4">
    <form id="filter-form" class="row g-2 align-items-center">
      <div class="col-auto">
        <input type="checkbox" id="filter_nursery" class="form-check-input">
        <label for="filter_nursery" class="form-check-label">授乳室あり</label>
      </div>
      <div class="col-auto">
        <input type="checkbox" id="filter_category_park" class="form-check-input">
        <label for="filter_category_park" class="form-check-label">公園のみ</label>
      </div>
      
    </form>
  </div>

  <% if user_signed_in? %>
    <div class="text-end mb-4">
      <%= link_to '施設・公園を新規登録する', new_public_place_path, class: 'btn btn-success' %>
    </div>
  <% end %>

  <!-- Google Map -->
    <div id="map" style="width: 100%; height: 800px;" class="mb-4"></div>

  <!-- ピンをクリックした時に表示するバナー -->
    <div id="place-info-banner" class="card shadow-sm fixed-bottom m-4" style="display: none; max-width: 600px;">
      <div class="card-body d-flex align-items-center">
        <img id="place-photo" src="" alt="施設写真" style="width: 100px; height: 100px; object-fit: cover;" class="me-3 rounded">
      <div>
      <h5 id="place-name" class="mb-1"></h5>
      <p id="place-details" class="mb-0 small text-muted"></p>
      <a href="#" id="place-link" class="btn btn-sm btn-primary mt-2">詳細を見る</a>
    </div>
  </div>
</div>


  <script
    async defer src="https://maps.googleapis.com/maps/api/js?key=<%= ENV['GOOGLE_MAPS_API_KEY'] %>&libraries=places&callback=initMap">
  </script>      


<script>
  window.places = <%= raw @places.to_json(
    only: [:id, :name, :latitude, :longitude, :category, :nursery],
    methods: [:main_image_url, :comments_count, :likes_count, :facility_summary, :place_path]
  ) %>;  
</script>


<%= javascript_pack_tag 'place_index_map' %>
